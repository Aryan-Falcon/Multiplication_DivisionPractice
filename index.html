<!DOCTYPE html> 
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Multiplication RPG ‚Äî Arcane Tower</title>

<style>
    body {
        margin: 0;
        padding: 0;
        font-family: 'Georgia', serif;
        background: radial-gradient(circle at center, #3a0057, #120018);
        color: #f8e7ff;
        overflow-x: hidden;
    }

    h1 {
        text-align: center;
        font-size: 42px;
        margin-top: 20px;
        color: #ffd6ff;
        text-shadow: 0 0 15px #ff6cff;
    }

    /* === RANK PROGRESS BAR (LEFT SIDE) === */
    #rank-panel {
        position: fixed;
        top: 50px;
        left: 20px;
        height: 500px;
        width: 170px;
        display: flex;
        gap: 10px;
        z-index: 200;
    }

    #rank-bar-container {
        width: 25px;
        height: 500px;
        background: #2a0038;
        border: 2px solid #ff9dff;
        border-radius: 8px;
        overflow: hidden;
        position: relative;
    }

    #rank-fill {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 0%;
        background: linear-gradient(to top, #ff00ff, #ffb7ff);
        transition: height 0.4s ease-out;
    }

    #rank-labels {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 500px;
        font-size: 16px;
        padding-left: 5px;
    }

    .rank {
        opacity: 0.3;
        filter: brightness(0.5);
        transition: all 0.5s;
    }

    .rank.active {
        opacity: 1;
        filter: brightness(1.8);
        text-shadow: 0 0 10px #ff8dff;
    }

    /* Battlefield */
    #battlefield {
        margin-top: 40px;
        display: flex;
        justify-content: space-around;
        align-items: center;
        text-align: center;
    }

    .character {
        width: 200px;
        height: 200px;
        background-size: cover;
    }

    #hero {
        background-image: url('https://i.etsystatic.com/49218806/r/il/141e80/6557512067/il_fullxfull.6557512067_asdh.jpg');
    }

    #monster {
        background-image: url('https://p1.hiclipart.com/preview/549/267/644/monster-rpg-maker-mv-rpg-maker-vx-game-roleplaying-game-slime-slime-morimori-dragon-quest-video-game-development-png-clipart.jpg');
        transition: opacity 0.5s, transform 0.5s;
    }

    #hp-bars {
        margin-top: 20px;
        text-align: center;
        font-size: 24px;
    }

    .hp-bar {
        width: 60%;
        height: 25px;
        background: #3a003a;
        border: 2px solid #ffb7ff;
        margin: 10px auto;
    }

    .hp-fill {
        height: 100%;
        background: #ff55ff;
        width: 100%;
        transition: width 0.5s;
    }

    #question-box {
        margin-top: 30px;
        font-size: 32px;
        font-weight: bold;
        text-align: center;
    }

    input {
        margin-top: 15px;
        font-size: 26px;
        padding: 8px;
        width: 150px;
        display: block;
        margin-left: auto;
        margin-right: auto;
        text-align: center;
        border-radius: 10px;
        border: none;
    }

    #log {
        font-size: 20px;
        margin-top: 20px;
        min-height: 60px;
        text-align: center;
    }

    #streak-indicator {
        font-size: 22px;
        margin-top: 10px;
        color: #ffd0ff;
        text-align: center;
        text-shadow: 0 0 10px #ff7cff;
        transition: transform 0.2s;
    }

    #results {
        margin-top: 40px;
        font-size: 28px;
        font-weight: bold;
        text-align: center;
    }

    button {
        margin-top: 25px;
        padding: 12px 25px;
        background: #c200ff;
        border: none;
        border-radius: 10px;
        color: white;
        font-size: 26px;
        cursor: pointer;
    }

    button:hover { background: #ff2eff; }

    /* === Bigger, Brighter Spell Projectile === */
    .spell {
        position: absolute;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: radial-gradient(circle, #ffffff, #ff66ff, #b200d6);
        box-shadow: 0 0 40px #ff44ff, 0 0 80px #ff00ff;
        pointer-events: none;
        animation: spellFly 0.7s linear forwards;
    }

    /* Monster‚Äôs spell is blue */
    .spell.monster {
        background: radial-gradient(circle, #ffffff, #66ccff, #0066ff);
        box-shadow: 0 0 40px #55aaff, 0 0 80px #0088ff;
    }

    /* Glowing tail */
    .spell::after {
        content: "";
        position: absolute;
        width: 20px;
        height: 80px;
        background: rgba(255, 0, 255, 0.4);
        filter: blur(10px);
        left: 20px;
        top: -40px;
        transform: rotate(180deg);
    }

    @keyframes spellFly {
        from { transform: scale(1); opacity: 1; }
        to { transform: scale(1.8); opacity: 0; }
    }

    /* Impact flash on hit */
    .impact {
        position: absolute;
        width: 140px;
        height: 140px;
        background: radial-gradient(circle, white, rgba(255,0,255,0.3), transparent);
        border-radius: 50%;
        pointer-events: none;
        animation: impactFlash 0.4s forwards;
    }

    @keyframes impactFlash {
        from { opacity: 1; transform: scale(0.5); }
        to { opacity: 0; transform: scale(2); }
    }
</style>
</head>

<body>

<h1>‚öîÔ∏è Multiplication RPG: Arcane Tower ‚öîÔ∏è</h1>

<!-- === RANK BAR === -->
<div id="rank-panel">
    <div id="rank-bar-container">
        <div id="rank-fill"></div>
    </div>

    <div id="rank-labels">
        <div class="rank" id="rank6">Grandmaster ‚ú®</div>
        <div class="rank" id="rank5">Archmage üîÆ</div>
        <div class="rank" id="rank4">Mage ‚ö°</div>
        <div class="rank" id="rank3">Adept üìò</div>
        <div class="rank" id="rank2">Apprentice üåÄ</div>
        <div class="rank" id="rank1">Novice ‚öîÔ∏è</div>
    </div>
</div>

<div id="battlefield">
    <div id="hero" class="character"></div>
    <div id="monster" class="character"></div>
</div>

<div id="hp-bars">
    Hero HP
    <div class="hp-bar"><div id="hero-hp" class="hp-fill"></div></div>

    Monster HP
    <div class="hp-bar"><div id="monster-hp" class="hp-fill"></div></div>
</div>

<div id="streak-indicator">Streak: 0</div>

<div id="question-box"></div>

<input type="number" id="answer" placeholder="Press ENTER">

<div id="log"></div>

<div id="results"></div>

<script>
let questions = [];
let current = 0;
let score = 0;

let streak = 0;
let monstersDefeated = 0;

let heroHP = 100;
let monsterHP = 60;

const ranks = [
    "Novice",
    "Apprentice",
    "Adept",
    "Mage",
    "Archmage",
    "Grandmaster"
];

// === Generate 30 questions ===
for (let i = 0; i < 30; i++) {
    let a = Math.ceil(Math.random() * 11);
    let b = Math.ceil(Math.random() * 11);
    questions.push({ a, b });
}

function updateRankBar() {
    let progress = (score / 30) * 100;
    document.getElementById("rank-fill").style.height = progress + "%";

    let level = Math.ceil((score / 30) * 6);

    for (let i = 1; i <= 6; i++) {
        const label = document.getElementById("rank" + i);
        if (i <= level) label.classList.add("active");
        else label.classList.remove("active");
    }
}

function showQuestion() {
    if (current >= questions.length || heroHP <= 0) {
        endGame();
        return;
    }

    let q = questions[current];
    document.getElementById("question-box").innerHTML =
        `Question ${current + 1}/30:<br>${q.a} √ó ${q.b} = ?`;
}

// === Spell System ===
function castSpell(fromId, toId, isMonster = false) {
    let from = document.getElementById(fromId);
    let to = document.getElementById(toId);

    let rect1 = from.getBoundingClientRect();
    let rect2 = to.getBoundingClientRect();

    let spell = document.createElement("div");
    spell.className = "spell";
    if (isMonster) spell.classList.add("monster");

    spell.style.left = (rect1.left + rect1.width/2 - 30) + "px";
    spell.style.top = (rect1.top + rect1.height/2 - 30) + "px";

    let dx = (rect2.left + rect2.width/2) - (rect1.left + rect1.width/2);
    let dy = (rect2.top + rect2.height/2) - (rect1.top + rect1.height/2);

    spell.animate(
        [
            { transform: `translate(0px,0px)` },
            { transform: `translate(${dx}px, ${dy}px)` }
        ],
        { duration: 700, easing: "ease-out" }
    );

    document.body.appendChild(spell);

    setTimeout(() => {
        spell.remove();

        // Impact flash
        let flash = document.createElement("div");
        flash.className = "impact";
        flash.style.left = (rect2.left + rect2.width/2 - 70) + "px";
        flash.style.top = (rect2.top + rect2.height/2 - 70) + "px";
        document.body.appendChild(flash);
        setTimeout(() => flash.remove(), 400);
    }, 700);
}

function explodeMonster() {
    let target = document.getElementById("monster");
    let boom = document.createElement("div");
    boom.className = "explode";

    let rect = target.getBoundingClientRect();
    boom.style.left = (rect.left + rect.width/2 - 100) + "px";
    boom.style.top = (rect.top + rect.height/2 - 100) + "px";

    document.body.appendChild(boom);
    setTimeout(() => boom.remove(), 800);
}

function spawnMonster() {
    monsterHP = 60;
    document.getElementById("monster-hp").style.width = "100%";
    let mon = document.getElementById("monster");
    mon.style.opacity = 1;
    mon.style.transform = "scale(1)";
}

function submitAnswer() {
    let input = document.getElementById("answer");
    let userAnswer = Number(input.value);
    let q = questions[current];
    let correct = q.a * q.b;

    if (userAnswer === correct) {
        score++;
        streak++;

        updateRankBar();

        let dmg = 10 + (streak * 5);
        if (dmg > 25) dmg = 25;

        monsterHP -= dmg;

        castSpell("hero", "monster");

        document.getElementById("log").innerHTML =
            `‚ú® Correct! You dealt <strong>${dmg}</strong> damage!`;

        if (monsterHP <= 0) {
            monstersDefeated++;
            explodeMonster();

            document.getElementById("log").innerHTML +=
                `<br>üí• You defeated the monster!`;

            setTimeout(spawnMonster, 700);
        }

    } else {
        castSpell("monster", "hero", true);

        streak = 0;
        heroHP -= 10;

        document.getElementById("hero").classList.add("hit");
        setTimeout(() => document.getElementById("hero").classList.remove("hit"), 400);

        document.getElementById("log").innerHTML =
            `‚ùå Wrong! Correct: <strong>${correct}</strong>. Monster hits you!`;
    }

    document.getElementById("streak-indicator").innerHTML = `Streak: ${streak}`;

    document.getElementById("hero-hp").style.width = heroHP + "%";
    document.getElementById("monster-hp").style.width = monsterHP + "%";

    input.value = "";
    current++;
    showQuestion();
}

document.getElementById("answer").addEventListener("keydown", function(e) {
    if (e.key === "Enter") submitAnswer();
});

function endGame() {
    let pct = score / 30;
    let rankIndex = Math.max(0, Math.min(5, Math.floor(pct * 6)));
    let finalRank = ranks[rankIndex];

    let finalMsg = `
        <p>You Defeated <strong>${monstersDefeated}</strong> monsters!</p>
        <p>Your Score: <strong>${score}/30</strong></p>
        <p>Your Final Rank: <strong>${finalRank}</strong> üèÜ</p>
    `;

    document.getElementById("results").innerHTML = finalMsg +
        `<button onclick="location.reload()">Play Again</button>`;
}

showQuestion();
updateRankBar();
</script>

</body>
</html>
